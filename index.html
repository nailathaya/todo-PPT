<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PPT - To-Do List</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/flowbite@4.0.0/dist/flowbite.min.css" rel="stylesheet" />
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            bg: '#f1f5f9',
            surface: '#ffffff',
            border: '#e2e8f0',
            primary: {
              DEFAULT: '#2563eb',
              soft: '#dbeafe',
              hover: '#1d4ed8',
            },
            danger: '#dc2626',
            text: '#0f172a',
            muted: '#6b7280',
          },
          fontFamily: {
            sans: ['system-ui', 'Segoe UI', 'Roboto', 'sans-serif'],
          },
          boxShadow: {
            soft: '0 10px 25px -15px rgba(15, 23, 42, 0.5)',
          },
        },
      },
    };
  </script>
</head>
<body class="min-h-screen bg-bg text-text font-sans">
  <div class="min-h-screen flex items-center justify-center px-4 py-10">
    <main class="w-full max-w-3xl bg-surface rounded-2xl shadow-soft border border-border p-6 sm:p-8">
      <header class="mb-6 sm:mb-8 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
        <div>
          <h1 class="text-2xl sm:text-3xl font-semibold tracking-tight">PPT To-Do List</h1>
          <p class="text-sm text-muted mt-1">Add, edit, and manage your tasks with time ranges.</p>
        </div>
      </header>

      <!-- Error / Status -->
      <div id="statusBar" class="hidden mb-4">
        <div id="statusContent" class="text-sm px-3 py-2 rounded-md"></div>
      </div>

      <!-- Add To-Do Form -->
      <section aria-labelledby="add-todo-title" class="mb-8">
        <h2 id="add-todo-title" class="text-lg font-medium mb-3">Add a new to-do</h2>
        <form id="todoForm" class="grid grid-cols-1 gap-4" autocomplete="off">
          <div>
            <label for="todoName" class="block text-sm font-medium mb-1">Name<span class="text-red-500">*</span></label>
            <input id="todoName" name="todoName" type="text" required
              class="block w-full rounded-lg border border-border bg-white px-3 py-2 text-sm focus:border-primary focus:ring-2 focus:ring-primary/40 outline-none" placeholder="e.g. Prepare meeting slides" />
          </div>
          <div>
            <label for="todoDescription" class="block text-sm font-medium mb-1">Description</label>
            <textarea id="todoDescription" name="todoDescription" rows="3"
              class="block w-full rounded-lg border border-border bg-white px-3 py-2 text-sm focus:border-primary focus:ring-2 focus:ring-primary/40 outline-none" placeholder="Add some context or notes (optional)"></textarea>
          </div>
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div>
              <label for="startTime" class="block text-sm font-medium mb-1">Start time</label>
              <input id="startTime" name="startTime" type="time"
                class="block w-full rounded-lg border border-border bg-white px-3 py-2 text-sm focus:border-primary focus:ring-2 focus:ring-primary/40 outline-none" />
            </div>
            <div>
              <label for="endTime" class="block text-sm font-medium mb-1">End time</label>
              <input id="endTime" name="endTime" type="time"
                class="block w-full rounded-lg border border-border bg-white px-3 py-2 text-sm focus:border-primary focus:ring-2 focus:ring-primary/40 outline-none" />
            </div>
          </div>
          <div class="flex items-center justify-between gap-3 mt-1">
            <p class="text-xs text-muted">Fields marked with * are required. Time range is optional.</p>
            <button type="submit"
              class="inline-flex items-center justify-center rounded-lg bg-primary px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-hover disabled:opacity-60 disabled:cursor-not-allowed"
              id="addTodoBtn">
              Add to-do
            </button>
          </div>
        </form>
      </section>

      <!-- To-Do List -->
      <section aria-labelledby="todo-list-title">
        <div class="flex items-center justify-between mb-3">
          <h2 id="todo-list-title" class="text-lg font-medium">Your to-dos</h2>
          <button id="refreshBtn" type="button"
            class="text-xs px-2.5 py-1.5 rounded-md border border-border text-muted hover:bg-slate-50">
            Refresh
          </button>
        </div>
        <div id="todoList" class="space-y-3" aria-live="polite"></div>
        <p id="emptyState" class="text-sm text-muted mt-2 hidden">No to-dos yet. Add your first one above.</p>
      </section>
    </main>
  </div>

  <!-- Edit Modal -->
  <div id="editModal" tabindex="-1" aria-hidden="true"
    class="fixed inset-0 z-50 hidden items-center justify-center bg-black/40">
    <div class="bg-surface border border-border rounded-2xl shadow-soft w-full max-w-md mx-4 p-5">
      <div class="flex items-start justify-between mb-4">
        <h3 class="text-lg font-medium">Edit to-do</h3>
        <button type="button" id="closeEditModal"
          class="text-muted hover:text-text rounded-full p-1">
          &#10005;
        </button>
      </div>
      <form id="editTodoForm" class="space-y-4">
        <input type="hidden" id="editTodoId" />
        <div>
          <label for="editTodoName" class="block text-sm font-medium mb-1">Name<span class="text-red-500">*</span></label>
          <input id="editTodoName" type="text" required
            class="block w-full rounded-lg border border-border bg-white px-3 py-2 text-sm focus:ring-2 focus:ring-primary/40" />
        </div>
        <div>
          <label for="editTodoDescription" class="block text-sm font-medium mb-1">Description</label>
          <textarea id="editTodoDescription" rows="3"
            class="block w-full rounded-lg border border-border bg-white px-3 py-2 text-sm"></textarea>
        </div>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label for="editStartTime" class="block text-sm font-medium mb-1">Start time</label>
            <input id="editStartTime" type="time"
              class="block w-full rounded-lg border border-border bg-white px-3 py-2 text-sm" />
          </div>
          <div>
            <label for="editEndTime" class="block text-sm font-medium mb-1">End time</label>
            <input id="editEndTime" type="time"
              class="block w-full rounded-lg border border-border bg-white px-3 py-2 text-sm" />
          </div>
        </div>
        <div class="flex justify-end gap-2 pt-2">
          <button type="button" id="cancelEditBtn"
            class="px-3 py-2 text-sm rounded-md border border-border text-muted hover:bg-slate-50">
            Cancel
          </button>
          <button type="submit" id="saveEditBtn"
            class="inline-flex items-center justify-center rounded-lg bg-primary px-4 py-2 text-sm font-medium text-white hover:bg-primary-hover">
            Save changes
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- SCRIPT: LocalStorage + Auto Reset -->
  <script>
    const STORAGE_KEY = 'ppt_todos_v1';

    // Reset otomatis saat halaman dibuka
    localStorage.removeItem(STORAGE_KEY);

    function loadFromStorage() {
      const data = localStorage.getItem(STORAGE_KEY);
      return data ? JSON.parse(data) : [];
    }

    function saveToStorage(data) {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
    }

    async function createTodo(data) {
      const todos = loadFromStorage();
      const id = crypto.randomUUID();
      todos.push({ id, ...data });
      saveToStorage(todos);
    }

    async function listTodos() {
      return loadFromStorage();
    }

    async function updateTodo(id, data) {
      const todos = loadFromStorage().map(t => t.id === id ? { ...t, ...data } : t);
      saveToStorage(todos);
    }

    async function deleteTodo(id) {
      saveToStorage(loadFromStorage().filter(t => t.id !== id));
    }

    document.addEventListener('DOMContentLoaded', () => {
      const todoForm = document.getElementById('todoForm');
      const todoListEl = document.getElementById('todoList');
      const emptyStateEl = document.getElementById('emptyState');
      const refreshBtn = document.getElementById('refreshBtn');

      const editModal = document.getElementById('editModal');
      const editTodoId = document.getElementById('editTodoId');
      const editTodoName = document.getElementById('editTodoName');
      const editTodoDescription = document.getElementById('editTodoDescription');
      const editStartTime = document.getElementById('editStartTime');
      const editEndTime = document.getElementById('editEndTime');

      function openEdit(todo) {
        editTodoId.value = todo.id;
        editTodoName.value = todo.name;
        editTodoDescription.value = todo.description || '';
        editStartTime.value = todo.startTime || '';
        editEndTime.value = todo.endTime || '';
        editModal.classList.add('flex');
        editModal.classList.remove('hidden');
      }

      function closeEdit() {
        editModal.classList.add('hidden');
        editModal.classList.remove('flex');
      }

      async function renderTodos() {
        const todos = await listTodos();
        todoListEl.innerHTML = '';
        emptyStateEl.classList.toggle('hidden', todos.length > 0);

        todos.forEach(todo => {
          const item = document.createElement('article');
          item.className = 'flex items-start justify-between border rounded-lg p-3 bg-white';

          item.innerHTML = `
            <div>
              <h3 class="font-medium">${todo.name}</h3>
              <p class="text-xs text-muted">${todo.description || ''}</p>
            </div>
            <div class="flex gap-2">
              <button class="text-xs border px-2 rounded" data-edit="${todo.id}">Edit</button>
              <button class="text-xs border px-2 rounded text-red-600" data-del="${todo.id}">Delete</button>
            </div>
          `;

          item.querySelector(`[data-edit="${todo.id}"]`).onclick = () => openEdit(todo);
          item.querySelector(`[data-del="${todo.id}"]`).onclick = async () => {
            await deleteTodo(todo.id);
            renderTodos();
          };

          todoListEl.appendChild(item);
        });
      }

      todoForm.onsubmit = async (e) => {
        e.preventDefault();
        const form = new FormData(todoForm);
        await createTodo({
          name: form.get('todoName'),
          description: form.get('todoDescription') || '',
          startTime: form.get('startTime') || '',
          endTime: form.get('endTime') || ''
        });
        todoForm.reset();
        renderTodos();
      };

      document.getElementById('editTodoForm').onsubmit = async (e) => {
        e.preventDefault();
        await updateTodo(editTodoId.value, {
          name: editTodoName.value,
          description: editTodoDescription.value,
          startTime: editStartTime.value,
          endTime: editEndTime.value
        });
        closeEdit();
        renderTodos();
      };

      document.getElementById('closeEditModal').onclick = closeEdit;
      document.getElementById('cancelEditBtn').onclick = closeEdit;
      refreshBtn.onclick = renderTodos;

      renderTodos();
    });
  </script>

<script src="https://cdn.jsdelivr.net/npm/flowbite@4.0.0/dist/flowbite.min.js"></script>
</body>
</html>